package com.parvanpajooh.cargoarchive.controller;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.multipart.MultipartFile;
import org.springframework.web.multipart.MultipartHttpServletRequest;
import org.apache.commons.io.IOUtils;

@Controller
public class MyController {

  @ResponseBody
  @RequestMapping(value = "submitFiles", method = RequestMethod.POST)
  public String submitPapers(MultipartHttpServletRequest request) {
    List < MultipartFile > papers = request.getFiles("papers");
    try {
      saveFilesToServer(papers);
    } catch (Exception e) {
      return "error";
    }
    return "success";
  }

  public void saveFilesToServer(List<MultipartFile> multipartFiles) throws IOException {
  	String directory = "/home/user/uploadedFilesDir/";
	File file = new File(directory);
	file.mkdirs();
	for (MultipartFile multipartFile : multipartFiles) {
		file = new File(directory + multipartFile.getOriginalFilename());
		IOUtils.copy(multipartFile.getInputStream(), new FileOutputStream(file));
	}
  }

}
